Emmon Croot, Jan 2024

@ The telomeres bed file was obtained from
https://s3-us-west-2.amazonaws.com/human-pangenomics/T2T/CHM13/assemblies/annotation/chm13v2.0_telomere.bed,
via the T2T consortium github (https://github.com/marbl/chm13) (2024-01-10), and edited to only contain terminal
telomeres (chr3 and chr11 ITS deleted). Then, the script get_non-telomere_regions.py was run to find the inverse of the
regions contained within the telomeres bed file (i.e. the start and end of the non-telomere chromosomes), which are
more useful for these analyses.

@ The genes file was obtained from ftp://ftp.ccb.jhu.edu/pub/data/T2T-CHM13/chm13v2.0_RefSeq_Liftoff_v4.gff3
(https://ccb.jhu.edu/T2T.shtml, 2023-08-04),
originally for eccDNA annotations. get_just_genes.py was run to keep only genes info (thereby reducing the size
of the file to be more manageable for these analyses)

@ The secondary genes file /ref_files/CAT_liftoff_from_table_browser.csv was downloaded from the UCSC table browser on
Jan15th, using the following settings:

    assembly: T2T/hs1
    group: genes and gene predictions
    track: CAT/LiftOff genes
    table: hub_567047_catLiftOffGenesV1
    region: genome
    output format: selected fields
    output field separator: csv
    file type: plain text

    selected fields:
    chrom	Reference sequence chromosome or scaffold
    chromStart	Start position in chromosome
    chromEnd	End position in chromosome
    name	Name
    name2	Gene name

    columns were renamed to merge well with other dfs
    seqid	start	end	name	Gene

    This files at least contains some AC.... AP.... genes, allowing more of the names in the input file to be annotated.

@ the censat file was obtained from the T2T github on Jan23rd,
https://s3-us-west-2.amazonaws.com/human-pangenomics/T2T/CHM13/assemblies/annotation/chm13v2.0_censat_v2.0.bed
and bedtools merge was used to generate single centromere regions for each chr
# bedtools merge -i chm13v2.0_censat_v2.0.bed > censat_merged.bed
chrY entries were checked and added manually

@ the ideogram file was downloaded from the UCSC Table Browser (24th Jan 2024) to cytobands.tsv, using the settings:

    assembly: T2T/hs1
    group: Mapping and Sequencing
    track: cytobands (Ideogram)
    table: hub_3671779_cytoBandIdeo
    region: genome
    output format: all fields
    output field separator: tsv
    file type: plain text

and centromeres were extracted using get_centromeres.py

@ the fragile sites file was generated manually, from two original files:

    1. cytobands (chm13v2.0_cytobands_allchrs.bed) downloaded from: 
        http://t2t.gi.ucsc.edu/chm13/hub/t2t-chm13-v2.0/download/chm13v2.0_cytobands_allchrs.bed.gz  (02/08/2023)
    2. Fragile sites were downloaded from HGNC 
        https://www.genenames.org/tools/search/#!/?query=&rows=20&start=0&filter=document_type:gene&filter=locus_type:%22Fragile%20site%22 (02/08/23), 
        named hgnc_fragile_sites.txt. Cytoband information was extracted from the downloaded file names fields in this file using the short script 
        get_bands_from_hgnc.py, and presented in an additional column in the file hgnc_bandnames.txt
    3. The hgnc data (containing cytoband information) was joined with the HumCFS data (with FRA4E edited to be FRA4F, according to evidence 
        given in changes_made_to_humcfs_downloads.ods) on fragile site symbol. For the 8 fragile sites that were only present in HumCFS (not HGNC), 
        FRA2S, FRA2L, FRA5H, FRA6H, FRA7K, FRA9G, FRA13E and FRAXF, the HumCFS website 
        (e.g. https://webs.iiitd.edu.in/raghava/humcfs/browse_sub1.php?token=FRA5H&col=2) was used to find the cytoband for the site. 
        For FRA4F, this was added manually, with the cytoband 4q22, as detailed in literature. 
    4. The fragile site and cytoband information was then joined to the cytoband bed file, using join_cytoband_bed_and_fragile_sites.py, resulting in 
        sites_and_positions_first.tsv. However, there were some gaps where the cytoband positions didn’t exactly match. 
        e.g. if the HumCFS data contains the position 1p36, but the cytoband data only contains information for the sections of the band (e.g. 1p36.11, 1p36.2 etc.), 
        the join wouldn’t work and the row would be left blank. The positions for these 45 bands were then added in manually, taking the lower and upper boundaries 
        of the relevant sections from the cytobands file.

########################################################################################################################
In brief, the script gene_tel_distance performs the following:

1. reads in
    * the file containing the lists of genes
    * the edited files described above
2. extracts gene names (using the 'gene_name' attribute) from the attributes column of the refseq/liftoff genes file
3. merges the input files into a large dataset with relevant data associations
4. calculates the gene length (gene end position - gene start position)
5. calculates the distances between both ends of the gene and both telomeres, and takes the minimum of these 4 distances
6. adds the chr:1-9 format locations to the data
7. discards irrelevant data
8. identifies duplicate genes, and outputs these to a separate file for reference
9. identifies genes that were not found in the refseq/liftoff file, and outputs these to a separate file for reference
10. outputs a csv file containing all the genes, their chr, start, end, length, distance to telomere and formatted loc
11. also outputs an excel file containing the same information for each of the original gene lists (one list per sheet)

example output:
Gene,Chr,Start,End,Gene_length,Distance_to_telomere,Gene_loc
TENT2,chr5,80096704,80172520,75816,80094304,chr5:80096704-80172520
FMNL1-DT,chr17,46044557,46075484,30927,38198316,chr17:46044557-46075484

#################################
sorting out the additional ~700 genes that aren't in chm13v2.0_RefSeq_Liftoff_v4.gff3






